# Database
DATABASE_URL=postgresql://isekai:isekai@localhost:5433/isekai

# Redis
REDIS_URL=redis://localhost:6379

# DeviantArt OAuth (Main App)
DEVIANTART_CLIENT_ID=your_client_id
DEVIANTART_CLIENT_SECRET=your_client_secret

# Cloudflare R2
R2_ACCOUNT_ID=your_account_id
R2_ACCESS_KEY_ID=your_access_key
R2_SECRET_ACCESS_KEY=your_secret_key
R2_BUCKET_NAME=isekai-uploads

# Publisher Worker Configuration
PUBLISHER_CONCURRENCY=5                   # Number of concurrent jobs per worker (default: 5)
PUBLISHER_MAX_ATTEMPTS=7                  # Max retry attempts for failed jobs (default: 7)
PUBLISHER_JOB_TIMEOUT_MS=600000           # Job timeout in milliseconds (default: 600000 = 10 min)
PUBLISHER_STALE_CHECK_INTERVAL_MS=60000   # Check for stalled jobs interval (default: 60000 = 1 min)
PUBLISHER_MAX_STALLED_COUNT=2             # Max stalled attempts before failure (default: 2)

# Rate Limiter Configuration
RATE_LIMITER_ENABLED=true                 # Enable adaptive rate limiter (default: true)
RATE_LIMITER_BASE_DELAY_MS=3000           # Base delay between requests (default: 3000 = 3 seconds)
RATE_LIMITER_MAX_DELAY_MS=300000          # Max delay between requests (default: 300000 = 5 minutes)
RATE_LIMITER_JITTER_PERCENT=20            # Jitter percentage for delays (default: 20)
RATE_LIMITER_SUCCESS_DECREASE_FACTOR=0.9  # Decrease delay after success (default: 0.9)
RATE_LIMITER_FAILURE_INCREASE_FACTOR=2.0  # Increase delay after failure (default: 2.0)

# Circuit Breaker Configuration
CIRCUIT_BREAKER_ENABLED=true              # Enable circuit breaker for rate limiting (default: true)
CIRCUIT_BREAKER_THRESHOLD=3               # Number of 429 errors before opening circuit (default: 3)
CIRCUIT_BREAKER_OPEN_DURATION_MS=300000   # Stay open for 5 minutes (default: 300000)
CIRCUIT_BREAKER_PERSIST_TO_REDIS=true     # Persist circuit state to Redis (default: true)

# Cache Configuration
CACHE_ENABLED=true                        # Master switch for Redis caching (default: true)
CACHE_DEFAULT_TTL=300                     # Default cache TTL in seconds (default: 300 = 5 minutes)
CACHE_STALE_TTL=7200                      # Stale cache TTL in seconds for 429 fallback (default: 7200 = 2 hours)

# Metrics & Monitoring
METRICS_ENABLED=true                      # Enable metrics collection (default: true)
METRICS_FLUSH_INTERVAL_MS=60000           # Flush metrics to Redis interval (default: 60000 = 1 min)
LOG_LEVEL=info                            # Log level: debug, info, warn, error (default: info)

# Health Check Server
HEALTH_CHECK_PORT=4001                    # Port for health check HTTP server (default: 4001)
HEALTH_CHECK_ENABLED=true                 # Enable health check endpoint (default: true)

# Environment
NODE_ENV=development
